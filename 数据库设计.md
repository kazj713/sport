# 体育平台应用数据库设计文档

## 数据库概述

本文档详细描述了体育平台应用的数据库设计，包括表结构、关系和索引设计。数据库采用SQLite兼容的Cloudflare D1数据库，通过Cloudflare Workers进行访问和操作。

## 核心表结构

### 用户管理

1. **users表**
   - 存储所有用户的基本信息
   - 支持多种用户类型：教练、学生、管理员
   - 包含验证状态、创建时间等基础字段

2. **coach_profiles表**
   - 存储教练特有的详细信息
   - 包含简介、经验年限、小时费率、评分等
   - 与users表一对一关联

3. **student_profiles表**
   - 存储学生特有的详细信息
   - 包含健身水平、健康信息、训练目标等
   - 与users表一对一关联

4. **coach_certifications表**
   - 存储教练的各种证书和资质
   - 包含证书名称、发证机构、有效期等
   - 与coach_profiles表一对多关联

### 课程管理

1. **sport_categories表**
   - 存储所有支持的运动类型
   - 包含名称、描述、图标等信息

2. **coach_specialties表**
   - 存储教练与运动类别的多对多关系
   - 包含专长详情、经验年限等

3. **courses表**
   - 存储所有课程信息
   - 包含标题、描述、难度级别、最大学生数、价格等
   - 支持一次性和周期性课程

4. **course_bookings表**
   - 存储学生预订课程的记录
   - 包含预订状态、出勤情况等
   - 与courses表和student_profiles表关联

### 支付系统

1. **payments表**
   - 存储所有支付交易
   - 包含金额、支付方式、交易ID、支付状态等
   - 记录平台费用、教练收入、退款信息

### 评价反馈

1. **reviews表**
   - 存储学生对教练和课程的评价
   - 包含专业水平、沟通能力、守时程度、总体评分等多维度评分
   - 支持教练回应功能

### 场地服务

1. **venues表**
   - 存储训练场地信息
   - 包含名称、地址、设施、联系方式等

2. **venue_bookings表**
   - 存储教练预订场地的记录
   - 包含预订时间、状态等

### 社区互动

1. **community_posts表**
   - 存储社区内容
   - 包含标题、内容、点赞数、评论数等

2. **community_comments表**
   - 存储帖子评论
   - 包含内容、点赞数等

### 训练数据

1. **training_data表**
   - 存储学生训练记录和进度
   - 包含训练日期、时长、笔记、成就、指标等

### 通知系统

1. **notifications表**
   - 存储系统通知
   - 包含标题、内容、通知类型、阅读状态等

## 索引设计

为提高查询性能，数据库设计了以下索引：

- 用户邮箱和电话索引
- 教练和学生资料的用户ID索引
- 教练认证和专长的教练ID索引
- 课程的教练ID、类别ID和开始时间索引
- 课程预订的课程ID和学生ID索引
- 支付的学生ID和教练ID索引
- 评价的教练ID和学生ID索引
- 场地预订的场地ID和教练ID索引
- 社区帖子的用户ID索引
- 社区评论的帖子ID索引
- 训练数据的学生ID索引
- 通知的用户ID和阅读状态索引

## 初始数据

数据库初始化时包含以下预设数据：

- 10种常见运动类别：足球、篮球、网球、游泳、瑜伽、健身、跑步、武术、舞蹈、高尔夫

## 数据关系图

```
users
 ├── coach_profiles
 │    ├── coach_certifications
 │    ├── coach_specialties
 │    ├── courses
 │    │    └── course_bookings
 │    └── venue_bookings
 └── student_profiles
      ├── course_bookings
      ├── payments
      ├── reviews
      └── training_data
```

此数据库设计支持体育平台应用的所有核心功能，包括用户管理、课程管理、支付系统、评价机制、场地预订和社区功能。设计遵循关系型数据库最佳实践，确保数据完整性和查询效率。
